<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Estimating Genome Size Using Jellyfish and GenomeScope2 | Dr. R. Jordan Price </title> <meta name="author" content="R. Jordan Price"> <meta name="description" content="A guide to estimating genome size using k-mer distributions."> <meta name="keywords" content="bioinformatics, bioinformatician, computational-biology, molecular-biology, functional-genomics, academic-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%AC&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://rj-price.github.io/blog/2024/jellyfish/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Dr. R. Jordan Price </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">news </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Estimating Genome Size Using Jellyfish and GenomeScope2</h1> <p class="post-meta"> November 17, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/bioinformatics"> <i class="fa-solid fa-hashtag fa-sm"></i> bioinformatics</a>   <a href="/blog/tag/genomics"> <i class="fa-solid fa-hashtag fa-sm"></i> genomics</a>   <a href="/blog/tag/visualisation"> <i class="fa-solid fa-hashtag fa-sm"></i> visualisation</a>   <a href="/blog/tag/kmer"> <i class="fa-solid fa-hashtag fa-sm"></i> kmer</a>     ·   <a href="/blog/category/getting-started"> <i class="fa-solid fa-tag fa-sm"></i> getting-started</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Understanding genome size is a fundamental step in genomics. It provides crucial insights into an organism’s biology, helps in planning sequencing projects, and is essential for interpreting downstream analyses.</p> <p>Estimating genome size from sequencing data is an efficient and cost-effective method that uses k-mer distributions to infer genome characteristics, including size, heterozygosity, and repeat content.</p> <p>In this blog post, we’ll walk through a workflow for genome size estimation using <strong>Jellyfish</strong> and <strong>GenomeScope2</strong>.</p> <p><br></p> <h2 id="background">Background</h2> <h3 id="why-estimate-genome-size">Why Estimate Genome Size?</h3> <p>Genome size, most commonly measured in base pairs, varies widely across organisms. Accurate estimates guide sequencing depth requirements, inform assembly strategies, and provide insights into evolutionary biology, such as genome duplication or repeat content.</p> <p><br></p> <h3 id="theory-behind-the-tools">Theory Behind the Tools</h3> <p><strong>K-mers</strong> are sequences of length <em>k</em> bases (e.g., 21 bases for <em>k = 21</em>). If <em>k</em> is sufficiently large to ensure uniqueness and the genome length greatly exceeds <em>k</em>, the total number of k-mers approximately equals the genome size. Sequencing errors and repeats influence k-mer counts, creating distinct patterns in k-mer frequency histograms.</p> <p><strong>Jellyfish</strong> efficiently counts k-mers in sequencing reads, producing a k-mer histogram that reflects the genome’s complexity. The peak of the histogram corresponds to the most frequent k-mer coverage, while the distribution of peaks reveals features such as heterozygosity, repeats, and sequencing errors.</p> <p><strong>GenomeScope2</strong> interprets k-mer histograms to estimate genome size, heterozygosity, and repeat content. It uses a statistical model to fit the histogram, assuming a specific ploidy. The output includes plots visualising the k-mer frequency distribution, estimated genome size, heterozygosity, and repeat content, providing an intuitive overview of the genome’s structure and complexity.</p> <p><br></p> <h2 id="the-workflow">The Workflow</h2> <p>As an example, we’ll use a script that I wrote for analysing sequencing data from haploid fungal isolates, which is optimised for execution on a Slurm-based HPC cluster.</p> <p>Here is the script we’ll use:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#SBATCH -J jellyfish</span>
<span class="c">#SBATCH --partition=short</span>
<span class="c">#SBATCH --mem=4G</span>
<span class="c">#SBATCH --cpus-per-task=2</span>

<span class="c"># INPUTS</span>
<span class="nv">Reads</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">Prefix</span><span class="o">=</span><span class="nv">$2</span>
<span class="nv">OutDir</span><span class="o">=</span><span class="nv">$3</span>
<span class="nv">KMER</span><span class="o">=</span><span class="nv">$4</span>

<span class="nb">source </span>activate jellyfish

<span class="nb">echo</span> <span class="s2">"Running jellyfish with the following parameters:"</span>
<span class="nb">echo</span> <span class="s2">"Reads: </span><span class="nv">$Reads</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"Prefix: </span><span class="nv">$Prefix</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"Kmer Size: </span><span class="nv">$KMER</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"Output Directory: </span><span class="nv">$OutDir</span><span class="s2">"</span>

<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$OutDir</span>

zcat <span class="nv">$Reads</span> | jellyfish count <span class="nt">-C</span> <span class="nt">-m</span> <span class="nv">$KMER</span> <span class="nt">-s</span> 1G <span class="nt">-t</span> 4 <span class="nt">-o</span> <span class="nv">$OutDir</span>/<span class="nv">$Prefix</span>.jf /dev/fd/0

jellyfish histo <span class="nt">-t</span> 4 <span class="nv">$OutDir</span>/<span class="nv">$Prefix</span>.jf <span class="o">&gt;</span> <span class="nv">$OutDir</span>/<span class="nv">$Prefix</span>.histo

genomescope2 <span class="nt">--input</span> <span class="nv">$OutDir</span>/<span class="nv">$Prefix</span>.histo <span class="nt">--kmer_length</span> <span class="nv">$KMER</span> <span class="nt">--ploidy</span> 1 <span class="nt">--max_kmercov</span> 10000 <span class="nt">--output</span> <span class="nv">$OutDir</span> <span class="nt">--name_prefix</span> <span class="nv">$Prefix</span>

<span class="nb">echo</span> <span class="s2">""</span>
<span class="nb">echo</span> <span class="s2">"Run complete."</span>
<span class="c"># If you're organism is a diploid, you can also upload $Prefix.histo to &lt;http://genomescope.org/&gt; to determine estimated genome size and heterozygosity rate.</span>

</code></pre></div></div> <p><br></p> <h3 id="inputs-and-parameters">Inputs and Parameters</h3> <ol> <li> <strong>Reads:</strong> Path to the gzipped sequencing reads.</li> <li> <strong>Prefix:</strong> Name prefix for output files.</li> <li> <strong>OutDir:</strong> Directory to store output files.</li> <li> <strong>KMER:</strong> K-mer size, typically 21-31 for most genomes.</li> </ol> <p><br></p> <h3 id="outputs">Outputs</h3> <ul> <li> <code class="language-plaintext highlighter-rouge">Prefix.jf</code>: Jellyfish database of k-mers.</li> <li> <code class="language-plaintext highlighter-rouge">Prefix.histo</code>: K-mer frequency histogram.</li> <li>GenomeScope2 results, including plots and summary files documenting genome size estimate, heterozygosity, and repeat content.</li> </ul> <p><br></p> <h2 id="step-by-step-breakdown">Step-by-Step Breakdown</h2> <h3 id="step-1-k-mer-counting-with-jellyfish">Step 1: K-mer Counting with Jellyfish</h3> <p>Jellyfish efficiently counts k-mers from sequencing reads. The script uses:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">C</code>: Counts canonical k-mers (ignores reverse complements).</li> <li> <code class="language-plaintext highlighter-rouge">m</code>: Specifies the k-mer length.</li> <li> <code class="language-plaintext highlighter-rouge">s</code>: Sets the hash size (1G here).</li> <li> <code class="language-plaintext highlighter-rouge">t</code>: Threads for parallel processing.</li> </ul> <p><br></p> <h3 id="step-2-generate-k-mer-histogram">Step 2: Generate K-mer Histogram</h3> <p>The histogram shows k-mer frequencies. A typical histogram includes:</p> <ul> <li>A sharp peak at low frequencies (sequencing errors).</li> <li>A main peak (true genomic k-mers).</li> <li>Secondary peaks (repeats or heterozygous k-mers).</li> </ul> <p><br></p> <h3 id="step-3-analyze-with-genomescope2">Step 3: Analyze with GenomeScope2</h3> <p>GenomeScope2 fits a model to the k-mer histogram:</p> <ul> <li>Estimates genome size.</li> <li>Identifies heterozygosity and repeat content.</li> <li>Supports different ploidies.</li> </ul> <p>The results include detailed plots, such as the k-mer frequency distribution, and numerical summaries, making it easy to interpret the genome’s complexity and structure.</p> <p><br></p> <h2 id="running-the-script">Running the Script</h2> <h3 id="example-command">Example Command</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sbatch genome_size_estimation.sh reads.fq.gz sample_name ./output_dir 21

</code></pre></div></div> <ul> <li> <code class="language-plaintext highlighter-rouge">reads.fq.gz</code>: Input sequencing reads.</li> <li> <code class="language-plaintext highlighter-rouge">sample_name</code>: Prefix for output files.</li> <li> <code class="language-plaintext highlighter-rouge">./output_dir</code>: Directory for results.</li> <li> <code class="language-plaintext highlighter-rouge">21</code>: K-mer size.</li> </ul> <p><br></p> <h3 id="interpreting-results">Interpreting Results</h3> <p>The GenomeScope2 output includes:</p> <ul> <li> <strong>Genome Size:</strong> Estimated size in base pairs.</li> <li> <strong>Heterozygosity:</strong> Proportion of heterozygous sites.</li> <li> <strong>Repeat Content:</strong> Percentage of the genome that is repetitive.</li> </ul> <p><br></p> <h2 id="additional-tips">Additional Tips</h2> <ol> <li> <strong>Choosing K-mer Size:</strong> <ul> <li>Smaller k-mers capture more data but may inflate error peaks.</li> <li>Larger k-mers reduce errors but require higher coverage.</li> </ul> </li> <li> <strong>Quality Control:</strong> Ensure input reads are high quality and adapter-trimmed.</li> <li> <strong>Ploidy Consideration:</strong> For diploid organisms, adjust <code class="language-plaintext highlighter-rouge">-ploidy</code> to 2 in GenomeScope2.</li> </ol> <p><br></p> <p>By integrating Jellyfish and GenomeScope2, you can quickly estimate genome size and other critical genomic properties. This workflow is especially useful for non-model organisms or projects in the early stages of genomic analysis.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/dotfiles/">Useful Bash Aliases and Functions</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/bash/">Getting Started with the Bash Command Line</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/blast/">Getting Started with BLAST on the Command Line</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/venn/">4-Way Venn Diagram of Overlapping Gene Expression in R</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 R. Jordan Price. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>